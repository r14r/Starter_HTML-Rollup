!function(e){"use strict";function l(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var t=l(e);function s(e,l,t=null,s="log"){var a;a="log"==s?console.log:"info"==s?console.info:"warn"==s?console.warn:"error"==s?console.error:console.log,e<=1&&(t?a(`${e}/1] ${l}`,t):a(`${e}/1] ${l}`))}class a{constructor(e="data/matrix_xy_abc.json"){s(2,`app/construtor: read file ${e}`),t.default.json(e).then((e=>{this.parseData(e.rows.root)}))}levelName(e){var l="";try{l=e.levelValues?e.levelValues[0].value:0==e.level?"MAIN":"TOTALS"}catch(l){console.error(`levelName: ERROR ${l}`,e)}return l}levelNames(e){return null==e?void 0:e.join(", ")}parseData(e){const l="parseData";s(1,`${l} data=`,e.children),this.results=[];try{this.parseChildren(e.children,0,[])}catch(l){s(2,`${l} result=`,e.children,"error")}s(2,`${l} result=`,this.results)}addResult(e){this.results||(this.results=[]),this.results.push(e)}parseChildren(e,l,t){const a=`parseChildren/${l}`;null==t&&(t=[]),s(4,`${a}: 1 (${this.levelNames(t)}) children=`,e),e.forEach((e=>{var r=this.levelName(e);s(4,`${a}: 2 ${r}`,e),this.parseChild(e,l+1,[...t,this.levelName(e)]),s(4,`${a}: 3 ${r}: results=`,undefined)}))}parseChild(e,l=0,t){const a=`parseChild/${l}`,r=this.levelNames(t);if(null==t&&(t=[]),s(4,`${a}/${this.levelName(e)}: level=${t} (${this.levelNames(t)}) row=`,e),!e)return console.error(`${a} ERROR: row=`,e),[];if(e.isSubtotal){let l={level:e.level,levels:t,value:e.value,values:this.convert2array(e.values,e.level+1),isSubtotal:!0,child:e};s(2,`${a} -- ${r} item=`,l,"warn"),this.addResult(l)}if(e.children)return s(4,`${a} -> ${e.value} child=`,e),this.parseChildren(e.children,e.level+1,[...t]),[];{s(4,`${a} VALUES child=`,e);let l={level:e.level,levels:t,value:e.value,values:this.convert2array(e.values,e.level+1),isSubtotal:!1,child:e};s(2,`${a} ## ${r} child ${e.value} =`,l,"warn"),this.addResult(l)}}convert2array(e,l){return[...Object.keys(e).map((l=>e[l].value))]}}var r,n,i,o,c,d,u=(n=(r={parentClass:"parent",collapsedClass:"active",childClassPrefix:"child-"})&&r.tableSelector||"table",i=r&&r.parentClass||"header",o=r&&r.childClassPrefix||"",c=r&&r.collapsedClass||"collapsed",d=e=>{var l=o+e.getAttribute("id");e.parentNode.querySelectorAll("tr."+l).forEach((e=>{(e=>{e.style.display=e.style.display?"":"none"})(e),(e=>e.classList.contains(i)&&!e.classList.contains(c))(e)&&d(e)})),e.classList.toggle(c)},{init:function(){document.querySelectorAll(n).forEach((function(e){e.addEventListener("click",(e=>{e.target&&e.target.parentNode.matches("tr."+i)&&d(e.target.parentNode)}))}))}});window.addEventListener("DOMContentLoaded",u.init.bind(u)),window.addEventListener("load",(function(){new a}))}(d3);
